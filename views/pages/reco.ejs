<% layout('/layouts/boilerplate') %>

<body class="bg-light">
  <div class="container mt-5">
    <h2 class="mb-4">Add New Recommendation</h2>

    <!-- Display server-side validation errors -->
    <% if (typeof errors !== "undefined" && errors.length > 0) { %>
      <div class="alert alert-danger">
        <ul class="mb-0">
          <% errors.forEach(error => { %>
            <li><%= error.msg %></li>
          <% }) %>
        </ul>
      </div>
    <% } %>

    <form action="/recommendations" method="POST" class=" port needs-validation" novalidate>
      <div class="mb-3">
        <label for="recommendation" class="form-label">Recommendation</label>
        <textarea class="form-control" id="recommendation" name="recommendation" rows="3" required><%= typeof oldInput !== 'undefined' ? oldInput.recommendation : '' %></textarea>
        <div class="invalid-feedback">Please enter a recommendation.</div>
      </div>

      <div class="mb-3">
        <label for="studentAdvice" class="form-label">Student Advice</label>
        <textarea class="form-control" id="studentAdvice" name="studentAdvice" rows="3" required><%= typeof oldInput !== 'undefined' ? oldInput.studentAdvice : '' %></textarea>
        <div class="invalid-feedback">Please enter student advice.</div>
      </div>

      <div class="mb-3">
        <label for="teacherReview" class="form-label">Teacher Review</label>
        <textarea class="form-control" id="teacherReview" name="teacherReview" rows="3" required><%= typeof oldInput !== 'undefined' ? oldInput.teacherReview : '' %></textarea>
        <div class="invalid-feedback">Please enter teacher review.</div>
      </div>

      <button type="submit" class="btn btn-success">Submit</button>
      <a href="/recommendations/view" class="btn btn-secondary">Cancel</a>
    </form>
  </div>

  <!-- Bootstrap client-side validation -->
  <script>
    (() => {
      'use strict';
      const forms = document.querySelectorAll('.needs-validation');
      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();
  </script>
</body>
